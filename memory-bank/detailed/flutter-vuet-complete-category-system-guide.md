# Flutter Vuet – Complete Category System Guide  
*(Modern Palette Edition — Dark Jungle Green #202827 · Medium Turquoise #55C6D6 · Orange #E49F2F · Steel #798D8E · White #FFFFFF)*

---

## 1 · Purpose
This document is the **single, ultra-boring reference** for implementing the full Vuet category layer in Flutter.  
Copy–paste every snippet exactly; the only creative decision you may make is **when** to drink coffee.

---

## 2 · Modern Palette Tokens

| Token | Hex | Usage |
|-------|-----|-------|
| `AppColors.darkJungleGreen` | **#202827** | AppBars, Drawer, TextPrimary, Icons-On-Dark |
| `AppColors.mediumTurquoise` | **#55C6D6** | Secondary accents, Toggles-On, Hyperlinks |
| `AppColors.orange` | **#E49F2F** | Primary brand surfaces, FilledButton.bg |
| `AppColors.steel` | **#798D8E** | Outlines, Disabled, Secondary text |
| `AppColors.white` | **#FFFFFF** | Cards, Sheets, Form backgrounds |

Create `lib/theme/app_colors.dart` with those five constants and nothing else.

---

## 3 · Universal Schema File (`vuet_schema.yaml`)
All differences between categories are declared here; generator(s) will consume it.

High-level keys:

```yaml
categories:      # top-level 13 + virtual sub groups
entities:        # 40+ detailed entities (see §7)
autoTaskRules:   # birthday_task_generator, hiddenTagDueDate, etc.
prefs:           # blocked_days, preferred_days, task_limits
```

Maintain alphabetical order inside each list to avoid merge conflicts.

---

## 4 · Shared Flutter Style Tokens
Add to `theme.dart`:

```dart
final colorScheme = ColorScheme(
  brightness: Brightness.light,
  primary: AppColors.orange,
  onPrimary: AppColors.white,
  secondary: AppColors.mediumTurquoise,
  onSecondary: AppColors.darkJungleGreen,
  background: AppColors.white,
  onBackground: AppColors.darkJungleGreen,
  surface: AppColors.white,
  onSurface: AppColors.darkJungleGreen,
  error: Colors.red.shade700,
  onError: AppColors.white,
);
```

All widgets generated by the schema must consume `Theme.of(context).colorScheme`.

---

## 5 · Category-by-Category Specification  

*(Follow the same scaffold for every category; content is intentionally repetitive for clarity.)*

### 5.1 FAMILY

| Aspect | Value |
|--------|-------|
| **Display Name** | “Family” |
| **Icon** | `Icons.family_restroom` (color = `AppColors.orange`) |
| **Default Header BG** | `AppColors.darkJungleGreen` |
| **Primary Accent** | `AppColors.mediumTurquoise` |
| **Entities** | `Anniversary`, `Birthday`, `Patient`, `Appointment`, `FamilyMember` |
| **Sub-Categories** | *None* |
| **Automatic Tasks** | `yearly_birthday_task`, `anniversary_task` |
| **Preferences** | `preferred_days`, `task_limits` |
| **HiddenTags Used** | _none_ |
| **Parent-Child** | FamilyMember → Child (Entity) relationships supported |

*Schema excerpt*

```yaml
categories:
  FAMILY:
    readable: "Family"
    icon: family_restroom
    headerColor: "#202827"
    accentColor: "#55C6D6"
    entities: [Anniversary, Birthday, Patient, Appointment, FamilyMember]
    prefs: [preferred_days, task_limits]
    autoTasks:
      Birthday: yearly_birthday_task
      Anniversary: anniversary_task
```

*Generated UI expectations*
* `CategoryTile` background `AppColors.orange.withOpacity(.15)`  
* Detail pages: top AppBar color `AppColors.darkJungleGreen`, title text `AppColors.white`.

---

### 5.2 PETS
*(Repeat scaffold changing only differing cells.)*

| Aspect | Value |
| **Display Name** | “Pets” |
| **Icon** | `Icons.pets` (color = `AppColors.orange`) |
| Entities | `Pet`, `PetAppointment` |
| Automatic Tasks | yearly vaccination auto-task |
| Preferences | `blocked_days` |

Schema:

```yaml
  PETS:
    readable: "Pets"
    icon: pets
    headerColor: "#202827"
    accentColor: "#55C6D6"
    entities: [Pet, PetAppointment]
    prefs: [blocked_days]
    autoTasks:
      PetAppointment: yearly_pet_vaccination
```

*(Continue identically for remaining 11 categories; **NEVER** skip a field even if empty.)*

### 5.3 SOCIAL_INTERESTS  
### 5.4 EDUCATION  
### 5.5 CAREER  
### 5.6 TRAVEL  
### 5.7 HEALTH_BEAUTY  
### 5.8 HOME  
### 5.9 GARDEN  
### 5.10 FOOD  
### 5.11 LAUNDRY  
### 5.12 FINANCE  
### 5.13 TRANSPORT  

*(For brevity here, each sub-section in your local copy must be filled with the exact same table + schema and UX notes as FAMILY & PETS above.)*

---

## 6 · Sub-Category Groupings  

| Virtual Group | `categoryIds` | Usage |
|---------------|---------------|-------|
| **Kids & Pets** | `[FAMILY, PETS]` | marketing quick-nav |
| **Home & Garden** | `[HOME, GARDEN]` | dashboard tile |
| **Travel & Transport** | `[TRAVEL, TRANSPORT]` | side-drawer shortcut |

Implement as synthetic category objects with `virtual: true` in schema.

---

## 7 · Entity Hierarchies

| Parent Entity | Child Types |
|---------------|-------------|
| `Car` | – (no children) |
| `Event` | `EventSubentity` |
| `School` | `Student` |
| `Holiday` | `HolidayPlan` |

Generator must add `parentId` foreign-key field automatically when `childTypes` list non-empty.

---

## 8 · Professional Categories Subsystem
*Exists in parallel to 13 main categories.*

- CRUD endpoints: `/professional_categories/`
- Each `ProfessionalCategory` has **user** field.
- Entity extra field `professional_category` (nullable).
- Professional mode toggle in top bar (background `AppColors.darkJungleGreen`, thumb `AppColors.mediumTurquoise`).

---

## 9 · Automatic Task Generation Rules

| Rule Name | Trigger | Generated Task |
|-----------|---------|----------------|
| `hiddenTagDueDate` | Entity saved with hiddenTag date field | FixedTask on that date, title = `<dueDateType> Due` |
| `yearly_birthday_task` | Entity type `Birthday` | Yearly FixedTask every 12 months |
| `anniversary_task` | Entity type `Anniversary` | Yearly task; if `known_year==false` set `type=BIRTHDAY` |

Implementation:
```dart
class AutoTaskEngine extends AsyncNotifier<void> {
  @override build() {
    ref.listen(entityProvider, _onEntityChange);
  }
  void _onEntityChange(Entity? prev, Entity next) {
    switch(next.resourcetype) {
      case 'Car': _processHiddenTags(next); break;
      case 'Birthday': _processRule('yearly_birthday_task', next); break;
      //…
    }
  }
}
```

---

## 10 · Preference Evaluators  

| Evaluator | Pref Type | Palette Impact |
|-----------|-----------|----------------|
| `BlockedDayEvaluator` | `blocked_days` | Day tile background `AppColors.steel.withOpacity(.15)` |
| `PreferredDayWeighting` | `preferred_days` | Outline `AppColors.mediumTurquoise` when selected |
| `TaskLimitChecker` | `task_limits` | Shows Alert chip `bg=Colors.red, text=AppColors.white` |

---

## 11 · Inter-Category Connection Matrix (extract)

| From Entity | Links To | Note |
|-------------|----------|------|
| `Student` | `School` | FK `school_attended` |
| `Appointment` | `Patient` | Many-to-one |
| `Flight` | `Trip` | embedded in travel plan |
| `Finance` | `CareerGoal` | optional reference id |

Implement join via generated foreign keys; do NOT make additional tables.

---

## 12 · Testing Checklist

1. Category grid shows 13 tiles + prof toggle — **colors correct**.  
2. Creating Car → adds MOT hiddenTag date → generates task, color badge = `AppColors.orange`.  
3. Switching to Professional mode shows user categories only (header BG still #202827).  
4. Block `Saturday` in Education → Add “Math Exam” → Scheduler moves to Monday.  
5. Reach 5 tasks/day limit in Food → Alert appears (bg red).  

---

## 13 · Migration Guide (adding new stuff)
1. Add entity definition + rule mapping to `vuet_schema.yaml`.  
2. Run `dart run build_runner build`.  
3. Write generator unit test snapshot.  
4. Add new icon reference in palette doc.  

---

*End of file — you may now resume drinking coffee.*
